(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[892],{3947:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/users",function(){return s(6567)}])},6567:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return Users}});var l=s(5893),r=s(7294),d=s(6501),i=s(6154),t=s(9335),n=s(1664),c=s.n(n),o=s(2118),m=s(2824),u=s(8036);function Users(e){let{userData:a,setuserData:s}=e,[n,h]=(0,r.useState)([]),[v,p]=(0,r.useState)(),[x,b]=(0,r.useState)(""),[N,j]=(0,r.useState)([]),f="/api/user",g="Users",handleApi=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("create_user"===e)try{await (0,i.Z)({method:"POST",url:"/api/user",data:a,timeout:5e3,headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(e=>{p(e.data.data),d.ZP.success(e.data.massage),$(".btn-close").trigger("click"),document.getElementById("formCreate").reset(),handleApi("view_user")}).catch(e=>{if("ECONNABORTED"===e.code)d.ZP.error("Maaf database sedang mengalami gagal koneksi, harap kembali lagi nanti");else{var a,s;(null==e?void 0:null===(s=e.response)||void 0===s?void 0:null===(a=s.data)||void 0===a?void 0:a.massage)?d.ZP.error(e.response.data.massage):d.ZP.error(e.message)}})}catch(e){d.ZP.error(e.response.data.massage)}};return(0,r.useEffect)(()=>{var e,s,l,r,t,n;document.title=g;let handleApiFirst=async function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],"view_permission"===e)try{await (0,i.Z)({method:"GET",url:"/api/permission",headers:{Authorization:"Bearer ".concat(localStorage.getItem("token"))}}).then(e=>{j(e.data.data.map((e,a)=>({label:e.name,value:e.name})))})}catch(e){d.ZP.error(e.response.data.massage)}};handleApiFirst("view_permission"),h(null!==(n=null==a?void 0:null===(t=a.permission)||void 0===t?void 0:null===(r=t.data)||void 0===r?void 0:null===(l=r.map(e=>e.data.find(e=>{if(e.label==g)return e})))||void 0===l?void 0:null===(s=l.filter(e=>void 0!==e))||void 0===s?void 0:null===(e=s[0])||void 0===e?void 0:e.checklist)&&void 0!==n?n:[])},[a]),(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"row mb-32 gy-32",children:[(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("h1",{className:"hp-mb-0 text-4xl font-bold",children:g})}),(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("div",{className:"row justify-content-between gy-32",children:(0,l.jsx)("div",{className:"col hp-flex-none w-auto",children:(0,l.jsx)("nav",{"aria-label":"breadcrumb",children:(0,l.jsxs)("ol",{className:"breadcrumb",children:[(0,l.jsx)("li",{className:"breadcrumb-item",children:(0,l.jsx)(c(),{href:"/",children:"Home"})}),(0,l.jsx)("li",{className:"breadcrumb-item active",children:"Users"})]})})})})}),(0,l.jsx)("div",{className:"col-12 mt-10",children:(0,l.jsxs)("div",{className:"row g-16 align-items-center justify-content-end",children:[(0,l.jsx)("div",{className:"col-12 col-md-6 col-xl-4",children:(0,l.jsx)("div",{className:"input-group align-items-center",children:(0,l.jsx)(u.Z,{value:null!=x?x:"",onChange:e=>b(String(e)),className:"form-control ps-8",placeholder:"Search all columns..."})})}),n.find(e=>"create"==e)?(0,l.jsx)("div",{className:"col hp-flex-none w-auto",children:(0,l.jsxs)(t.Button,{type:"button",className:"w-100 px-5",variant:"gradient",color:"orange","data-bs-toggle":"modal","data-bs-target":"#addNewUser",children:[(0,l.jsx)("i",{className:"ri-add-line remix-icon"})," Add Users"]})}):null,(0,l.jsx)("div",{className:"modal fade -mt-2",id:"addNewUser",tabIndex:-1,"aria-labelledby":"addNewUserLabel","aria-hidden":"true","data-bs-keyboard":"false","data-bs-backdrop":"static",children:(0,l.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsxs)("div",{className:"modal-header py-16 px-24",children:[(0,l.jsx)("h5",{className:"modal-title font-bold",id:"addNewUserLabel",children:"Add Users"}),(0,l.jsx)("button",{type:"button",className:"btn-close hp-bg-none d-flex align-items-center justify-content-center","data-bs-dismiss":"modal","aria-label":"Close",children:(0,l.jsx)("i",{className:"ri-close-line hp-text-color-dark-0 lh-1",style:{fontSize:"24px"}})})]}),(0,l.jsx)("div",{className:"divider m-0"}),N.length?(0,l.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),e.target.password.value!==e.target.confirm_password.value){d.ZP.error("Password not match");return}if(e.target.password.value<8||e.target.confirm_password.value<8){d.ZP.error("Password min 8 char");return}handleApi("create_user",{username:e.target.username.value,email:e.target.email.value,fullName:e.target.fullName.value,phone:e.target.phone.value,address:e.target.address.value,dateOfBirth:e.target.dateOfBirth.value,role:e.target.role_val.value,password:e.target.password.value,confirm_password:e.target.confirm_password.value})},id:"formCreate",children:[(0,l.jsx)("div",{className:"modal-body",children:(0,l.jsxs)("div",{className:"row gx-8",children:[(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{type:"text",required:!0,variant:"standard",className:"border-b-1",name:"fullName",label:"Full Name",id:"name"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{type:"text",required:!0,variant:"standard",className:"border-b-1",name:"username",label:"Username",id:"username"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{type:"email",required:!0,variant:"standard",className:"border-b-1",name:"email",label:"Email",id:"email"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{type:"number",required:!0,variant:"standard",className:"border-b-1",name:"phone",label:"Phone",id:"nophone"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{type:"date",required:!0,variant:"standard",className:"border-b-1",name:"dateOfBirth",label:"Date Of Birth",id:"dateOfBirth"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(o.Z,{variant:"standard",required:!0,label:"Role",name:"role",id:"role",data:N})})}),(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Textarea,{required:!0,variant:"standard",className:"border-b-1",id:"address",label:"Address",name:"address"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{required:!0,type:"password",autoComplete:"",variant:"standard",className:"border-b-1",name:"password",label:"Password",id:"password"})})}),(0,l.jsx)("div",{className:"col-12 col-md-6",children:(0,l.jsx)("div",{className:"mb-24",children:(0,l.jsx)(t.Input,{required:!0,type:"password",autoComplete:"",variant:"standard",className:"border-b-1",name:"confirm_password",label:"Confirm Password",id:"confirm_password"})})})]})}),(0,l.jsxs)("div",{className:"modal-footer pt-0 px-24 pb-24",children:[(0,l.jsx)("div",{className:"divider"}),(0,l.jsx)(t.Button,{type:"submit",className:"w-full",color:"blue",children:"Submit"})]})]}):(0,l.jsx)("div",{className:"text-center font-semibold my-3",children:"Make permission first"})]})})})]})}),(0,l.jsx)("div",{className:"col-12",children:(0,l.jsx)("div",{className:"card hp-contact-card mb-32 -mt-3 shadow-md",children:(0,l.jsx)("div",{className:"card-body px-0",children:(0,l.jsx)(m.Z,{search:x,action:{delete:n.find(e=>"delete"==e)?f:null,edit:n.find(e=>"edit"==e)?f:null},urlFatch:f,reload:v,modalData:[{name:"fullName",type:"text",id:"fullName",required:!0},{name:"username",type:"text",id:"usernameEdit",required:!0},{name:"email",type:"email",id:"emailEdit",required:!0},{name:"phone",type:"number",id:"nophoneEdit",required:!0},{name:"dateOfBirth",type:"date",id:"dateOfBirthEdit",required:!0},{name:"role",type:"reactSelect",id:"roleEdit",select:N,required:!0},{name:"status",type:"reactSelect",id:"statusEdit",select:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"pending",label:"Pending"}],required:!0},{name:"address",type:"textarea",id:"addressEdit",required:!0,full:!0}]})})})})]})})}}},function(e){e.O(0,[224,35,774,888,179],function(){return e(e.s=3947)}),_N_E=e.O()}]);